<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
  integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" 
  crossorigin="*">
  <script src="https://code.jquery.com/jquery-latest.min.js"></script>
  <script>
    </script>
</head>
<body>
 
    <div class="row">
      <h4 style="margin-left: 20px;">
        <span style="margin-bottom: -84px;margin-left: 5px;">
          제품 번호
        </span></h4>
        <input type="text" id="inputId" style="margin-left: 24px;width: 208px;">
        <input type="button" onclick="getData()" value="검색" style="color:black;" >

      <div class="col-md-12">
        <table class="table" style="margin-top:  10px;width: 99%;margin-left: 10px;">
          <thead >
            <th style="border:1px solid black; font-size: 10px;">#</th>
            <th style="border:1px solid black; font-size: 10px;">created_at</th>
            <th style="border:1px solid black; font-size: 10px;">report_time</th>
            <th style="border:1px solid black; font-size: 10px;">device_id</th>
            <th style="border:1px solid black; font-size: 10px;">flag</th>
            <th style="border:1px solid black; font-size: 10px;">dust_pm10</th>
            <th style="border:1px solid black; font-size: 10px;">dust_pm2_5</th>
            <th style="border:1px solid black; font-size: 10px;">gas_no2</th>
            <th style="border:1px solid black; font-size: 10px;">voc</th>
            <th style="border:1px solid black; font-size: 10px;">gas_so2</th>
            <th style="border:1px solid black; font-size: 10px;">gas_co</th>
            <th style="border:1px solid black; font-size: 10px;">gas_o3</th>
            <th style="border:1px solid black; font-size: 10px;">gas_h2s</th>
            <th style="border:1px solid black; font-size: 10px;">gas_nh3</th>
            <th style="border:1px solid black; font-size: 10px;">hcho</th>
            <th style="border:1px solid black; font-size: 10px;">noise</th>
            <th style="border:1px solid black; font-size: 10px;">temp_out</th>
            <th style="border:1px solid black; font-size: 10px;">temp_in</th>
            <th style="border:1px solid black; font-size: 10px;">humid_out</th>
            <th style="border:1px solid black; font-size: 10px;">humid_in</th>
            <th style="border:1px solid black; font-size: 10px;">wind_direction</th>
            <th style="border:1px solid black; font-size: 10px;">wind_speed</th>
            <th style="border:1px solid black; font-size: 10px;">lte_access_freq</th>
            <th style="border:1px solid black; font-size: 10px;">firmware_version</th>
          </thead>
          <tbody id="result">
          </tbody>
        </table>
      </div>
    </div>

  <script src="https://code.jquery.com/jquery-latest.min.js"></script>
  <script type="text/javascript">
    var apiUrl;
    if (location.hostname === 'localhost') {
        apiUrl = 'http://localhost:5000/newjelly/raw_data_lg.html';
    } else{
        apiUrl = 'http://smart.aircok.com:13701/newjelly/raw_data_lg.html'
    }
    function getData() {
      var device_id = $('#inputId').val()  ?  $('#inputId').val()  : device_id = 'ALL';
      // var device_id = [{device_id:'180201356170062261293'}, {device_id:'180201356170062280749'}];
       $.ajax({
        url: 'http://lguplus.ethree.co.kr:11107/everylab/raw_data_lg?device_id='+device_id,
        type: 'GET',
        success: function(data) {
          var html = '';
          $.each(data, function(i, item) {
            html += '<tr>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.id + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.created_at.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(0, -3) + ":00" + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(0, 14) + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(15, 36) + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(37, 41) + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(42, 46) + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(47, 51) + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(52, 57) + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(58, 63) + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(64, 69) + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(70, 77) + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(78, 83) + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(84, 89) + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(90, 95) + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(96, 101) + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(102, 107) + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(108, 112) + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(113, 117) + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(118, 122) + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(123, 127) + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(128, 129) + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(130, 133) + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(134, 139) + '</td>';
            html += '<td style="font-size: 15px; border:1px solid black;">' + item.data.replace(/([^T]+)T([^\.]+).*/g, "$1 $2").slice(140, 144) + '</td>';
            html += '</tr>';
          });
          $('#result').html(html);
        },
        error: function(err) {
          console.log(err);
        }
      });
    }

    getData();

    setInterval(function() {
      getData();
    }, 300000);
  </script>

</body>
</html>
